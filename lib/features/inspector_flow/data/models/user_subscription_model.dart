import 'dart:developer';

import '../../domain/entities/user_subscription_entity.dart';

class UserSubscriptionModel extends UserSubscriptionEntity {
  const UserSubscriptionModel({
    required super.id,
    required super.userId,
    required super.planId,
    required super.stripeSubscriptionId,
    required super.customerId,
    required super.productId,
    required super.priceId,
    required super.stripeSubscriptionStatus,
    required super.collectionMethod,
    required super.startDate,
    required super.currentPeriodStart,
    required super.currentPeriodEnd,
    required super.trialStart,
    required super.trialEnd,
    required super.amount,
    required super.currency,
    required super.interval,
    required super.intervalCount,
    super.latestInvoiceUrl,
    super.latestInvoicePdf,
    super.latestInvoiceId,
    required super.livemode,
    required super.isDeleted,
    required super.createdAt,
    required super.updatedAt,
  });

  factory UserSubscriptionModel.fromJson(Map<String, dynamic> json) {
    log(
      'UserSubscriptionModel.fromJson response:\n$json',
      name: 'UserSubscriptionModel',
    );
    return UserSubscriptionModel(
      id: json['_id'] ?? '',
      userId: json['userId'] ?? '',
      planId: json['planId'] ?? '',
      stripeSubscriptionId: json['stripeSubscriptionId'] ?? '',
      customerId: json['customerId'] ?? '',
      productId: json['productId'] ?? '',
      priceId: json['priceId'] ?? '',
      stripeSubscriptionStatus: json['stripeSubscriptionStatus'] ?? '',
      collectionMethod: json['collectionMethod'] ?? '',
      startDate: json['startDate'] ?? 0,
      currentPeriodStart: json['currentPeriodStart'] ?? 0,
      currentPeriodEnd: json['currentPeriodEnd'] ?? 0,
      trialStart: json['trialStart'] ?? 0,
      trialEnd: json['trialEnd'] ?? 0,
      amount: json['amount'] ?? 0,
      currency: json['currency'] ?? '',
      interval: json['interval'] ?? '',
      intervalCount: json['intervalCount'] ?? 1,
      latestInvoiceUrl: json['latestInvoiceUrl'],
      latestInvoicePdf: json['latestInvoicePdf'],
      latestInvoiceId: json['latestInvoiceId'],
      livemode: json['livemode'] ?? false,
      isDeleted: json['isDeleted'] ?? false,
      createdAt: DateTime.tryParse(json['createdAt'] ?? '') ?? DateTime.now(),
      updatedAt: DateTime.tryParse(json['updatedAt'] ?? '') ?? DateTime.now(),
    );
  }

  Map<String, dynamic> toJson() => {
    '_id': id,
    'userId': userId,
    'planId': planId,
    'stripeSubscriptionId': stripeSubscriptionId,
    'customerId': customerId,
    'productId': productId,
    'priceId': priceId,
    'stripeSubscriptionStatus': stripeSubscriptionStatus,
    'collectionMethod': collectionMethod,
    'startDate': startDate,
    'currentPeriodStart': currentPeriodStart,
    'currentPeriodEnd': currentPeriodEnd,
    'trialStart': trialStart,
    'trialEnd': trialEnd,
    'amount': amount,
    'currency': currency,
    'interval': interval,
    'intervalCount': intervalCount,
    'latestInvoiceUrl': latestInvoiceUrl,
    'latestInvoicePdf': latestInvoicePdf,
    'latestInvoiceId': latestInvoiceId,
    'livemode': livemode,
    'isDeleted': isDeleted,
    'createdAt': createdAt.toIso8601String(),
    'updatedAt': updatedAt.toIso8601String(),
  };
}
